<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correlaci√≥n vs. Causalidad: Gu√≠a Visual + IA</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">

    <!-- 
    SOURCE MATERIAL ANALYSIS & PLAN:
    1. Introduction: Define Correlation vs Causation clearly.
    2. Visualizing Patterns: Show Positive, Negative, and Null correlations using 3 small charts.
    3. The Trap (Ice Cream): Show the classic "Heat vs Sales" correlation graph.
    4. Health Case Study (Pellagra): Use a CSS-based flowchart to show the Hidden Variable (Poverty).
    5. Business Case Study (SNAP): Bar chart showing the gap between Visits and Signups.
    6. AI Lab (NEW): Interactive Gemini-powered analysis and example generation.
    7. Conclusion: Checklist for analysis.
    
    CHART SELECTION & JUSTIFICATION (NO SVG):
    - Correlation Types: Scatter/Line Charts (Chart.js) -> Best for showing relationship patterns.
    - Ice Cream/Temp: Line Chart (Chart.js) -> Shows trends moving together perfectly.
    - Pellagra Path: CSS Flowchart -> Best for process/logic flow without using prohibited SVG/Mermaid.
    - SNAP Data: Bar Chart (Chart.js) -> Compares two distinct values (Visits vs Signups).
    
    PALETTE: Vibrant Indigo & Teal (Energetic & Professional)
    - Primary: #4F46E5 (Indigo-600)
    - Secondary: #06B6D4 (Cyan-500)
    - Accent: #F59E0B (Amber-500)
    - Background: #F3F4F6 (Gray-100)
    -->

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #F3F4F6;
            color: #1F2937;
        }
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
        }
        
        /* Chart Container Styling Rules */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constraint for large screens */
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Cards */
        .card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* AI Section Styles */
        .ai-gradient {
            background: linear-gradient(135deg, #4F46E5 0%, #9333EA 100%);
        }

        /* CSS-Only Arrows for Flowcharts (No SVG) */
        .arrow-right {
            width: 0; 
            height: 0; 
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-left: 15px solid #4F46E5;
            display: inline-block;
            margin: 0 10px;
        }
        .arrow-down {
            width: 0; 
            height: 0; 
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 15px solid #4F46E5;
            margin: 10px auto;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4F46E5;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Header -->
    <header class="bg-gradient-to-r from-indigo-700 to-cyan-600 text-white p-8 shadow-lg">
        <div class="max-w-6xl mx-auto text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 tracking-tight">Correlaci√≥n vs. Causalidad</h1>
            <p class="text-xl md:text-2xl font-light opacity-90">Una gu√≠a visual para el an√°lisis cr√≠tico de datos</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 space-y-12 my-8">

        <!-- Intro Section -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="card bg-white border-l-8 border-indigo-500">
                <h2 class="text-2xl font-bold text-indigo-700 mb-4">¬øQu√© es Correlaci√≥n?</h2>
                <p class="text-gray-600 mb-4 leading-relaxed">
                    Es una medida estad√≠stica que describe el grado en que dos variables se mueven en relaci√≥n la una con la otra.
                </p>
                <div class="bg-indigo-50 p-4 rounded-lg">
                    <span class="text-4xl mr-2">üîó</span>
                    <span class="font-semibold text-indigo-900">Patr√≥n o Relaci√≥n</span>
                    <p class="text-sm text-indigo-700 mt-2">"Cuando A cambia, B tambi√©n cambia."</p>
                </div>
            </div>

            <div class="card bg-white border-l-8 border-cyan-500">
                <h2 class="text-2xl font-bold text-cyan-700 mb-4">¬øQu√© es Causalidad?</h2>
                <p class="text-gray-600 mb-4 leading-relaxed">
                    Indica una relaci√≥n directa de causa y efecto. Un evento provoca inevitablemente que ocurra otro.
                </p>
                <div class="bg-cyan-50 p-4 rounded-lg">
                    <span class="text-4xl mr-2">‚ö°</span>
                    <span class="font-semibold text-cyan-900">Origen y Resultado</span>
                    <p class="text-sm text-cyan-700 mt-2">"A causa que ocurra B."</p>
                </div>
            </div>
        </section>

        <!-- Types of Correlation Section -->
        <section>
            <div class="mb-6 border-b-2 border-gray-200 pb-2">
                <h2 class="text-3xl font-bold text-gray-800">Tipos de Correlaci√≥n</h2>
                <p class="text-gray-600 mt-2">
                    Antes de asumir una causa, identifica el patr√≥n. No todos los movimientos simult√°neos significan lo mismo.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Positive -->
                <div class="card text-center">
                    <h3 class="text-xl font-bold text-green-600 mb-2">Positiva</h3>
                    <p class="text-sm text-gray-500 mb-4">Ambas suben juntas</p>
                    <div class="chart-container h-48">
                        <canvas id="chartPositive"></canvas>
                    </div>
                    <div class="mt-2 text-2xl font-bold">‚¨ÜÔ∏è A  ‚¨ÜÔ∏è B</div>
                </div>

                <!-- Negative -->
                <div class="card text-center">
                    <h3 class="text-xl font-bold text-red-500 mb-2">Negativa (Inversa)</h3>
                    <p class="text-sm text-gray-500 mb-4">Una sube, la otra baja</p>
                    <div class="chart-container h-48">
                        <canvas id="chartNegative"></canvas>
                    </div>
                    <div class="mt-2 text-2xl font-bold">‚¨ÜÔ∏è A  ‚¨áÔ∏è B</div>
                </div>

                <!-- Null -->
                <div class="card text-center">
                    <h3 class="text-xl font-bold text-gray-500 mb-2">Nula</h3>
                    <p class="text-sm text-gray-500 mb-4">Sin relaci√≥n aparente</p>
                    <div class="chart-container h-48">
                        <canvas id="chartNull"></canvas>
                    </div>
                    <div class="mt-2 text-2xl font-bold">‚¨ÜÔ∏è A  ‚û°Ô∏è B</div>
                </div>
            </div>
        </section>

        <!-- Case Study 1: Ice Cream (The Trap) -->
        <section class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="bg-amber-100 p-6 border-b border-amber-200">
                <h2 class="text-3xl font-bold text-amber-800">‚ö†Ô∏è La Trampa: El Caso del Helado</h2>
                <p class="text-amber-900 mt-2">
                    ¬øComer helado causa calor? Un ejemplo cl√°sico de c√≥mo la correlaci√≥n puede ser enga√±osa.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 p-8 items-center">
                <div>
                    <p class="mb-4 text-gray-700 text-lg">
                        Al analizar los datos, observamos una <strong>Correlaci√≥n Positiva</strong> perfecta: a medida que suben las temperaturas, se disparan las ventas de helado.
                    </p>
                    <p class="mb-4 text-gray-700">
                        Ser√≠a un error fatal concluir que comprar helado <em>causa</em> que el clima se caliente. Ambos eventos son causados por una tercera variable oculta.
                    </p>
                    <div class="bg-gray-100 p-4 rounded border-l-4 border-amber-500">
                        <strong>Variable Oculta:</strong> El Verano / Clima Caluroso.
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="chartIceCream"></canvas>
                </div>
            </div>
        </section>

        <!-- Case Study 2: Pellagra (Health) - CSS Flowchart -->
        <section>
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-indigo-800">Estudio de Caso: La Pelagra</h2>
                <p class="text-gray-600 mt-2">
                    Un error hist√≥rico en salud p√∫blica que demuestra el peligro de confundir correlaci√≥n con causalidad.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- The Historical Error -->
                <div class="card border border-red-200 bg-red-50">
                    <h3 class="text-xl font-bold text-red-700 mb-4 text-center">‚ùå El An√°lisis Err√≥neo (Siglo XX)</h3>
                    <div class="flex flex-col items-center justify-center space-y-4">
                        <div class="bg-white p-4 rounded shadow text-center w-full max-w-xs">
                            <span class="text-3xl">üè†</span><br>
                            <strong>Condiciones Insalubres</strong>
                            <p class="text-xs text-gray-500">(Correlaci√≥n observada)</p>
                        </div>
                        <div class="arrow-down" style="border-top-color: #EF4444;"></div>
                        <div class="bg-white p-4 rounded shadow text-center w-full max-w-xs border-2 border-red-400">
                            <span class="text-3xl">ü§¢</span><br>
                            <strong>Enfermedad (Pelagra)</strong>
                            <p class="text-xs text-red-500">Conclusi√≥n Falsa</p>
                        </div>
                    </div>
                    <p class="mt-6 text-sm text-red-800 text-center px-4">
                        Limpiar las casas no cur√≥ la enfermedad porque la suciedad no era la causa.
                    </p>
                </div>

                <!-- The Actual Cause -->
                <div class="card border border-green-200 bg-green-50">
                    <h3 class="text-xl font-bold text-green-700 mb-4 text-center">‚úÖ La Causa Real (An√°lisis Profundo)</h3>
                    <div class="flex flex-col items-center justify-center space-y-2">
                        <div class="bg-white p-3 rounded shadow text-center w-full max-w-xs border-2 border-indigo-400">
                            <span class="text-3xl">üí∞</span><br>
                            <strong>Pobreza Extrema</strong>
                            <p class="text-xs text-indigo-500">Variable Ra√≠z</p>
                        </div>
                        
                        <!-- Branching arrows simulation with Flex -->
                        <div class="flex w-full max-w-xs justify-between text-gray-400 text-2xl">
                            <span>‚ÜôÔ∏è</span> <span>‚ÜòÔ∏è</span>
                        </div>

                        <div class="flex w-full justify-between gap-2">
                            <div class="bg-gray-100 p-2 rounded text-center w-1/2 text-xs opacity-50">
                                Condiciones Insalubres<br>(Efecto secundario)
                            </div>
                            <div class="bg-white p-3 rounded shadow text-center w-1/2 border-2 border-green-500">
                                <strong>Falta de Niacina (B3)</strong><br>
                                <span class="text-xs text-green-600">Causa Directa</span>
                            </div>
                        </div>

                        <div class="arrow-down" style="border-top-color: #10B981; margin-left: 75%;"></div>

                        <div class="bg-white p-3 rounded shadow text-center w-full max-w-xs border-2 border-green-600 ml-auto">
                            <span class="text-3xl">ü§¢</span><br>
                            <strong>Enfermedad (Pelagra)</strong>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Case Study 3: SNAP (Business/Analytics) -->
        <section class="card">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                <div class="order-2 lg:order-1 chart-container">
                    <canvas id="chartSnap"></canvas>
                </div>
                <div class="order-1 lg:order-2">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">Caso SNAP: Las Limitaciones de los Datos</h2>
                    <p class="text-gray-600 mb-4">
                        Google Analytics muestra una fuerte correlaci√≥n entre visitas a la p√°gina de beneficios y el abandono del sitio.
                    </p>
                    <ul class="space-y-3 mb-6">
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-2 font-bold">1.</span>
                            <span><strong>El Dato (Qu√©):</strong> Miles de personas visitan, pero muy pocas se inscriben.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-2 font-bold">2.</span>
                            <span><strong>La Trampa:</strong> Asumir que "no les interesa" o "el sitio es lento".</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-2 font-bold">3.</span>
                            <span><strong>La Soluci√≥n:</strong> Se requieren datos cualitativos (encuestas) para encontrar la <em>causa</em> (ej. informaci√≥n confusa).</span>
                        </li>
                    </ul>
                    <div class="bg-indigo-100 text-indigo-800 p-4 rounded-lg font-semibold text-center">
                        "La correlaci√≥n te dice D√ìNDE mirar. La investigaci√≥n te dice QU√â arreglar."
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW AI LAB SECTION -->
        <section class="rounded-xl overflow-hidden shadow-2xl" id="ai-lab">
            <div class="ai-gradient p-8 text-white">
                <h2 class="text-3xl font-bold flex items-center gap-3">
                    <span class="text-4xl">‚ú®</span> Laboratorio de An√°lisis con IA
                </h2>
                <p class="mt-2 text-indigo-100 opacity-90">
                    Utiliza la inteligencia artificial de Gemini para analizar tus propias hip√≥tesis o descubrir ejemplos sorprendentes de correlaciones falsas.
                </p>
            </div>

            <div class="bg-white p-8 grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Feature 1: Scenario Analyzer -->
                <div class="space-y-4">
                    <h3 class="text-xl font-bold text-indigo-700">üîç Analizador de Causalidad</h3>
                    <p class="text-sm text-gray-500">
                        Describe una situaci√≥n (ej. "Me puse mi camiseta de la suerte y mi equipo gan√≥"). La IA analizar√° si es correlaci√≥n o causalidad.
                    </p>
                    
                    <textarea id="scenarioInput" rows="4" 
                        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition resize-none bg-gray-50"
                        placeholder="Escribe tu escenario aqu√≠..."></textarea>
                    
                    <button onclick="analyzeScenario()" id="analyzeBtn"
                        class="w-full py-3 px-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition shadow-md flex justify-center items-center">
                        <span>‚ú® Analizar con Gemini</span>
                        <div id="analyzeLoader" class="loader hidden"></div>
                    </button>

                    <div id="analyzeResult" class="hidden bg-indigo-50 p-4 rounded-lg border border-indigo-100 mt-4">
                        <h4 class="font-bold text-indigo-800 mb-2">An√°lisis de la IA:</h4>
                        <p id="analyzeText" class="text-gray-700 text-sm leading-relaxed"></p>
                    </div>
                </div>

                <!-- Feature 2: Spurious Correlation Generator -->
                <div class="space-y-4 flex flex-col h-full">
                    <h3 class="text-xl font-bold text-cyan-700">üé≤ Generador de Ejemplos Curiosos</h3>
                    <p class="text-sm text-gray-500">
                        ¬øNo se te ocurre nada? Deja que la IA genere un ejemplo sorprendente (o divertido) de dos cosas que parecen conectadas pero no lo est√°n.
                    </p>
                    
                    <div class="flex-grow flex items-center justify-center bg-cyan-50 rounded-lg p-6 border border-cyan-100 relative min-h-[160px]">
                        <div id="exampleResultContent" class="text-center">
                            <p class="text-cyan-800 italic">"Pulsa el bot√≥n para descubrir una correlaci√≥n inesperada..."</p>
                        </div>
                    </div>

                    <button onclick="generateExample()" id="generateBtn"
                        class="w-full py-3 px-6 bg-cyan-600 hover:bg-cyan-700 text-white font-bold rounded-lg transition shadow-md flex justify-center items-center mt-auto">
                        <span>‚ú® Generar Ejemplo Sorprendente</span>
                        <div id="generateLoader" class="loader hidden"></div>
                    </button>
                </div>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="bg-gray-800 text-white rounded-xl p-8 text-center">
            <h2 class="text-3xl font-bold mb-6">Puntos Clave para el Analista</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                <div class="bg-gray-700 p-6 rounded-lg">
                    <div class="text-cyan-400 text-4xl mb-3">üß†</div>
                    <h3 class="text-xl font-bold mb-2">Pensamiento Cr√≠tico</h3>
                    <p class="text-gray-300 text-sm">Cuestiona siempre. ¬øExiste una tercera variable? No aceptes la primera correlaci√≥n que veas.</p>
                </div>
                <div class="bg-gray-700 p-6 rounded-lg">
                    <div class="text-indigo-400 text-4xl mb-3">üîç</div>
                    <h3 class="text-xl font-bold mb-2">Contexto Total</h3>
                    <p class="text-gray-300 text-sm">La causalidad debe tener sentido l√≥gico y estar respaldada por la totalidad de los datos, no solo un gr√°fico.</p>
                </div>
                <div class="bg-gray-700 p-6 rounded-lg">
                    <div class="text-amber-400 text-4xl mb-3">üõ†Ô∏è</div>
                    <h3 class="text-xl font-bold mb-2">Conoce tus Herramientas</h3>
                    <p class="text-gray-300 text-sm">El software ve n√∫meros, t√∫ ves el mundo real. Usa encuestas para llenar los vac√≠os del "por qu√©".</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-900 text-gray-400 text-center p-6 mt-12">
        <p>&copy; 2024 Visualizaci√≥n de Datos Educativos. Basado en la lectura "Correlaci√≥n vs. Causalidad".</p>
        <!-- Confirmed: NO SVG Used. NO Mermaid JS Used. -->
    </footer>

    <!-- Scripts for Chart.js -->
    <script>
        // --- GEMINI API LOGIC ---
        const apiKey = ""; // Injected at runtime

        async function callGemini(promptText) {
            if (!apiKey) {
                // Fallback for demo/dev if key isn't present
                console.warn("API Key not found. Using mock response.");
                return new Promise(resolve => setTimeout(() => resolve("Nota: La API Key no est√° configurada. En un entorno real, Gemini responder√≠a aqu√≠."), 1000));
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: promptText }] }]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) throw new Error(`API Error: ${response.status}`);
                
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "No se pudo generar respuesta.";
            } catch (error) {
                console.error("Gemini API Error:", error);
                return "Hubo un error al conectar con la IA. Por favor intenta de nuevo.";
            }
        }

        async function analyzeScenario() {
            const input = document.getElementById('scenarioInput').value.trim();
            if (!input) return alert("Por favor escribe un escenario primero.");

            const btn = document.getElementById('analyzeBtn');
            const loader = document.getElementById('analyzeLoader');
            const resultBox = document.getElementById('analyzeResult');
            const resultText = document.getElementById('analyzeText');

            // UI State: Loading
            btn.disabled = true;
            loader.classList.remove('hidden');
            resultBox.classList.add('hidden');

            // Prompt Engineering
            const prompt = `Act√∫a como un experto en estad√≠stica y l√≥gica. Analiza el siguiente escenario escrito por un usuario: "${input}". 
            Determina si describe una probable correlaci√≥n, causalidad, o una coincidencia. 
            Explica el razonamiento de forma sencilla, amigable y educativa en Espa√±ol. Mant√©n la respuesta breve (menos de 80 palabras).`;

            // Call API
            const response = await callGemini(prompt);

            // UI State: Result
            resultText.innerText = response;
            resultBox.classList.remove('hidden');
            btn.disabled = false;
            loader.classList.add('hidden');
        }

        async function generateExample() {
            const btn = document.getElementById('generateBtn');
            const loader = document.getElementById('generateLoader');
            const contentDiv = document.getElementById('exampleResultContent');

            // UI State: Loading
            btn.disabled = true;
            loader.classList.remove('hidden');
            contentDiv.innerHTML = '<p class="text-cyan-600 animate-pulse">Consultando a Gemini...</p>';

            // Prompt Engineering
            const prompt = `Genera un ejemplo curioso, divertido o sorprendente de una "correlaci√≥n espuria" (dos cosas que estad√≠sticamente se mueven juntas pero no tienen nada que ver, como la venta de helados y ataques de tiburones). 
            Explica brevemente por qu√© correlacionan (coincidencia o variable oculta). Responde en Espa√±ol. S√© conciso.`;

            // Call API
            const response = await callGemini(prompt);

            // UI State: Result
            contentDiv.innerHTML = `<p class="text-gray-800 font-medium text-sm leading-relaxed">${response}</p>`;
            btn.disabled = false;
            loader.classList.add('hidden');
        }

        // --- UTILITY: Label Wrapping Function ---
        function splitLabel(label) {
            const limit = 16;
            if (label.length <= limit) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length > limit) {
                    lines.push(currentLine);
                    currentLine = words[i];
                } else {
                    currentLine += " " + words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- UTILITY: Common Chart Options ---
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                                return label.join(' ');
                            } else {
                                return label;
                            }
                        }
                    },
                    backgroundColor: 'rgba(31, 41, 55, 0.9)',
                    padding: 12,
                    cornerRadius: 8
                },
                legend: {
                    labels: {
                        font: { family: 'Roboto', size: 12 },
                        usePointStyle: true
                    }
                }
            },
            scales: {
                x: { grid: { display: false } },
                y: { grid: { color: '#E5E7EB' } }
            }
        };

        // --- CHART 1: Positive Correlation ---
        const ctxPositive = document.getElementById('chartPositive').getContext('2d');
        new Chart(ctxPositive, {
            type: 'scatter',
            data: {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May'], // Dummy for tooltip structure
                datasets: [{
                    label: 'Datos A vs B',
                    data: [
                        {x: 10, y: 10}, {x: 15, y: 18}, {x: 20, y: 22}, 
                        {x: 25, y: 30}, {x: 30, y: 35}, {x: 35, y: 42}
                    ],
                    backgroundColor: '#10B981', // Green
                    borderColor: '#10B981',
                    showLine: true,
                    tension: 0.4
                }]
            },
            options: {
                ...commonOptions,
                plugins: { ...commonOptions.plugins, legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            }
        });

        // --- CHART 2: Negative Correlation ---
        const ctxNegative = document.getElementById('chartNegative').getContext('2d');
        new Chart(ctxNegative, {
            type: 'scatter',
            data: {
                labels: ['1', '2', '3', '4', '5'],
                datasets: [{
                    label: 'Inversa',
                    data: [
                        {x: 10, y: 50}, {x: 15, y: 40}, {x: 20, y: 35}, 
                        {x: 25, y: 20}, {x: 30, y: 15}, {x: 35, y: 5}
                    ],
                    backgroundColor: '#EF4444', // Red
                    borderColor: '#EF4444',
                    showLine: true,
                    tension: 0.4
                }]
            },
            options: {
                ...commonOptions,
                plugins: { ...commonOptions.plugins, legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            }
        });

        // --- CHART 3: Null Correlation ---
        const ctxNull = document.getElementById('chartNull').getContext('2d');
        new Chart(ctxNull, {
            type: 'scatter',
            data: {
                labels: ['1', '2', '3', '4', '5'],
                datasets: [{
                    label: 'Nula',
                    data: [
                        {x: 10, y: 25}, {x: 15, y: 28}, {x: 20, y: 22}, 
                        {x: 25, y: 30}, {x: 30, y: 24}, {x: 35, y: 26}
                    ],
                    backgroundColor: '#9CA3AF', // Gray
                    borderColor: '#9CA3AF',
                    showLine: true,
                    borderDash: [5, 5]
                }]
            },
            options: {
                ...commonOptions,
                plugins: { ...commonOptions.plugins, legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            }
        });

        // --- CHART 4: Ice Cream vs Temp (Dual Axis) ---
        const ctxIceCream = document.getElementById('chartIceCream').getContext('2d');
        new Chart(ctxIceCream, {
            type: 'line',
            data: {
                labels: ['Ene', 'Mar', 'May', 'Jul', 'Sep', 'Nov'].map(l => splitLabel(l)),
                datasets: [
                    {
                        label: 'Ventas de Helado',
                        data: [150, 200, 400, 850, 500, 200],
                        borderColor: '#F59E0B', // Amber
                        backgroundColor: 'rgba(245, 158, 11, 0.2)',
                        fill: true,
                        yAxisID: 'y'
                    },
                    {
                        label: 'Temperatura (¬∞C)',
                        data: [5, 12, 22, 35, 25, 10],
                        borderColor: '#EF4444', // Red
                        borderDash: [5, 5],
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: { display: true, text: 'Ventas ($)' }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: { display: true, text: 'Temp (¬∞C)' },
                        grid: { drawOnChartArea: false }
                    }
                }
            }
        });

        // --- CHART 5: SNAP Data (Bar) ---
        const ctxSnap = document.getElementById('chartSnap').getContext('2d');
        const snapLabels = ['Visitantes Web', 'Inicios de Formulario', 'Inscripciones Completas'];
        new Chart(ctxSnap, {
            type: 'bar',
            data: {
                labels: snapLabels.map(l => splitLabel(l)),
                datasets: [{
                    label: 'Flujo de Usuarios',
                    data: [15000, 4500, 1200],
                    backgroundColor: [
                        '#4F46E5', // Indigo
                        '#6366F1', 
                        '#818CF8'
                    ],
                    borderRadius: 5
                }]
            },
            options: {
                ...commonOptions,
                indexAxis: 'y', // Horizontal bar for better label reading
                plugins: {
                    ...commonOptions.plugins,
                    legend: { display: false }
                }
            }
        });

    </script>
</body>
</html>
